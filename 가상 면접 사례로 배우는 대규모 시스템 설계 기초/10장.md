# 10장 알림시스템 설계

알림시스템
- 고객에게 정보를 비동기적으로 제공
- 모바일 푸시 알림, SMS 메시지, 이메일

## 알림 유형별 지원 방안

- ios: APNS로 발송
- 안드로이드: FCM으로 발송
- SMS: 트윌리오, 넥스모 같은 서비스 이용
- 이메일: 자체 이메일 서버, 센드그리드

## 알림 전송 및 수신 절차

### 초안

- 서비스에서 알림 서비스로 알림 요청
- 알림 전송을 위한 API 제공
- 제3자 제공 서비스로 알림 전송

### 개선안

- 알림 서버와 작업 사이에 큐를 둔다
- 실패시 큐 재시도

## 상세 설계

- 데이터 손실 방지: 알림 데이터를 데이터베이스에 보관후 재시도 로직 구현
- 알림 템플릿: 알림 대부분은 형식 비슷, 알림들의 형식 일관성 있게 유지 가능
- 알림 설정: 알림 설정 테이블을 둬서 사용자가 알림을 받지 않도록 설정
```
user_id
channel: 알림이 전송될 채널
opt_in: 해당 채널로 알림을 받을 것인지 여부
```
- 전송률 제한: 한 사용자가 받을 수 있는 알림의 빈도를 제한
- 재시도 방법: 알림 전송에 실패하면 해당 알림을 전용 큐에 넣는다, 같은 문제 계속 발생시 개발자에게 통지


### 생각 메모

- 알림 전송 타입보다는 채널이 더 명시적인 것 같음 type -> channel

