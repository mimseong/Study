# 12장 채팅 시스템 설계

## 1단계 문제 이해 및 설계 범위 확정

- 응답지연이 낮은 일대일 채팅 기능
- 최개 100명까지 참여할 수 있는 그룹 채팅 기능
- 사용자의 접속상태 표시 기능
- 다양한 단말 지원, 하나의 계정으로 여러 단말에 동시 접속 지원

## 2단계 개략적 설계안 제시 및 동의 구하기

### 채팅 서버 설계

```
클리이언트 <-> 채팅 서버 <-> 클라이언트
```

- 클라이언트는 서로 직접 통신하지 않고 채팅 서버와 통신한다
- 채팅 서버가 제공해야 하는 기능
  - 클라이언트로부터 메시지 수신
  - 메시지 수신자 결정 및 전달
  - 수신자가 접속 상태가 아닌 경우 접속할 때까지 메시지 보관

<img width="1002" alt="image" src="https://github.com/mimseong/Study/assets/50068946/b1494b28-a009-41a0-a9d9-72bf644d5ef5">

**폴링**
- 클라이언트가 주기적으로 서버에게 새 메시지가 있냐고 물어보는 방식
- 단점: 답해줄 메시지가 없는 경우 서버 자원 낭비

**롱 폴링**

- 새 메시지가 반환되거나 타임아웃 될 때까지 연결 유지
- 클라이언트는 메시지를 받으면 기존 연결 종료 & 서버에 새로운 요청을 보낸다
- 단점: 메시지를 보내는 클라이언트와 메시지를 받는 클라이언트가 같은 채팅서버가 아닐 수 있다
- 단점: 여전히 비효율적임

**웹소켓**

- 웹 서버와 웹 브라우저가 서로 실시간 메시지를 교환하는데 사용 (양방향!)
- 첫 번째 핸드셰이크를 주고 받은 이후 지속적 연결 유지
- HTTP와 동일하게 애플리케이션 계층에서 동작
- 평문 메시지 전송 방식으로 SSL/TLS 보안 계층으로 암호화 필요
- 80, 443 포트를 쓰기 때문에 방화벽이 있어도 잘 통신함

### 전체 시스템 개략적 설계



